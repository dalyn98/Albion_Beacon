# Albion Beacon — Project Guidelines (Single Source of Truth)

> 본 문서는 Gemini & GPT가 공유하는 단일 참조 문서입니다.  
> 모든 작업 전, 본문을 확인하고 동일 규칙을 따릅니다.

## 0. 목적 & 적용 범위
- 목적: 일관된 규칙·절차·품질 기준으로 개발 속도와 안정성을 높인다.
- 범위: 코드, 문서, 릴리즈, 협업 절차 전반에 적용.

## 1. 기본 원칙
- 계획 우선·점진적 개발: 코딩 전 최신 블루프린트/가이드라인 확인 → 최소 동작 버전부터 → 점진 개선.
- 싱글 소스: 규칙·상태·로드맵은 저장소 문서만 신뢰한다.

## 2. 소통 원칙
- 능동적 질의: 정보가 부족하면 먼저 질문한다.
- 명확한 요청: 기능 중심 설명 + 예상 출력/수행 예시를 함께 제공.
- 변경 공개: 큰 변경은 PR 본문에 배경/의도/대안을 요약.

### 2.1 선택·제안 설명 원칙
- 선택지 제시 시 **(1) 의미 (2) 장단점 (3) 추천 이유**를 간단히 붙인다.  
- 필요 시 표/목록으로 요약해 의사결정 속도를 높인다.

## 3. 코드 구조 & 전달 규칙
- 디렉터리: `src/` 하위 `client/`, `server/`, `core/`, `config/`.
- 짧은 파일은 **전체 코드**, 긴 파일은 **변경 스니펫(앞뒤 2–3줄 문맥 포함)**으로 공유.
- **퍼머링크** 사용: 파일 라인 범위 선택 → **Y** → `...#L10-L42` 고정 URL 전달.

## 4. 버전 & 릴리즈
- Python: **3.10**.
- 버전: 루트 **`VERSION`** 수동 증가(예: `v3.2.1`).
- 릴리즈: 초기엔 **Draft + Pre-release**, 정식 배포 시 해제.

## 5. CI / 품질 (GitHub Actions)
- 워크플로우:
  - **CI**: 린트/테스트/커버리지.
  - **Release**: `VERSION` 읽어 태그·릴리즈 자동 생성(초기 draft).
  - **Build (Windows)**: 수동 실행, `.exe`는 Artifacts로 제공.
  - **Lint & Autofix**: ruff 자동 포맷 + 자동 수정(봇 커밋) → 남은 에러만 수동 해결.
- 브랜치 전략: `main`(안정) / `dev`(통합) / `feature/*`.
- 브랜치 보호(권장): main은 PR 필수 + 상태 체크 통과.

## 6. 보안 & 설정
- 비밀값은 Settings → Secrets and variables → Actions에 저장.
- 설정: `.env` + `config/settings.py`(pydantic-settings 권장).
- `.gitignore`: `.env`, `__pycache__/`, `*.pcap`, `*.db`, `*.log` 등.

## 7. 블루프린트(프로젝트 청사진)
- 위치: `docs/blueprint.md`  
- 내용: 목표/기능/상태/코드 구조/최근 결정/로드맵.  
- 변경 시 본 문서 또는 워크플로우에 영향이 있으면 함께 업데이트.

## 8. 작업 절차(요약)
1) 요청 수신 → 본 문서/`docs/blueprint.md` 확인  
2) 설계/초안 → 교차 검토 → 수정 → 테스트 → 문서화  
3) PR 생성(배경/의도/대안 기재) → 머지 후 `VERSION` 갱신 시 릴리즈 자동화

## 9. 파일 전달 가이드
- **퍼머링크**: 파일 라인 범위 선택 → **Y** → URL 전달(내용 고정).  
- **Compare/PR diff**: 변경만 리뷰할 때 사용.  
- **패치(옵션)**: `git diff origin/main -- path > file.patch`.

## 10. 변경 관리
- 규칙/가이드라인/블루프린트 변경은 반드시 PR로 처리.  
- PR 본문에 변경 이유·영향·대안 요약.  
- 본 문서·블루프린트 변경 시 알림 워크플로우가 트리거됨.

## 11. 현재 운용 상태(요약)
- Python 3.10 / `VERSION` 방식 / Draft Release / 수동 Windows 빌드  
- ruff 자동 포맷·수정 활성화 / CI 별도 운용

*Last updated: (commit 시각 기준)*
